{% extends 'base.html' %}
{% block content %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.0.2"></script>
<div class="col-md-6 offset-md-3">
    <div class="mainContent">
        <br/>
        <style>
            .centered-box-container {
                display: flex;
                flex-direction: column;
                flex-wrap: wrap; /* Allows items to wrap to the next line if there's not enough room */
                justify-content: center; /* Centers items horizontally */
                align-items: center; /* Centers items vertically */
                gap: 0px; /* Ensures there's no space between the boxes */
            }

            .background-box {
                background-color: white;
                padding: 4px;
                box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.1);
                margin: 0; /* Removes space between boxes */
                width: 100%;
                overflow: hidden; /* Ensures the pseudo-element doesn't overflow */
            }
            .percentage-box {
                display: flex; /* Makes .percentage-box a flex container */
                justify-content: center; /* Centers children horizontally */
                align-items: center; /* Centers children vertically */
                flex-direction: column; /* Stacks children vertically */
                padding: 5px; 
                width: 100%;
                height: 100%;
                text-align: center; /* Centers text horizontally */
            }
            .modal {
                display: none; /* Hidden by default */
                position: fixed; /* Stay in place */
                z-index: 1; /* Sit on top */
                left: 0;
                top: 0;
                width: 100%; /* Full width */
                height: 100%; /* Full height */
                overflow: auto; /* Enable scroll if needed */
                background-color: rgb(0,0,0); /* Fallback color */
                background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
            }

            .modal-content {
                background-color: #312d38;
                margin: 15% auto; /* 15% from the top and centered */
                padding: 20px;
                border: 1px solid #888;
                width: 50%; /* Adjusted width */
                max-width: 600px; /* Optional: set a maximum width */
                position: relative;
            }

            .close {
                color: #ff0000;
                font-size: 28px;
                font-weight: bold;
                cursor: pointer;
                position: absolute; /* Position the close button */
                top: 10px; /* Adjust as needed */
                right: 20px; /* Adjust as needed */
            }

            .close:hover,
            .close:focus {
                color: black;
                text-decoration: none;
                cursor: pointer;
            }
            .horizontal-container {
                display: flex;
                justify-content: space-between;
                width: 100%;
            }

            .horizontal-container > div {
                flex: 1;
                text-align: center;
            }
            /* Responsive text scaling */
            .percentage-box h1 {
                font-size: 6vw; /* Adjust as needed */
            }

            .percentage-box h5, .percentage-box h6 {
                font-size: 3vw; /* Adjust as needed */
            }

            /* Media query for larger screens */
            @media (min-width: 768px) {
                .percentage-box h1 {
                    font-size: 2em; /* Adjust as needed */
                }

                .percentage-box h5, .percentage-box h6 {
                    font-size: 1em; /* Adjust as needed */
                }
            }

            .labelbox {
                flex: 1;
                text-align: center;
            }
            .calendar-grid {
                display: grid;
                grid-template-columns: repeat(7, 1fr);
                grid-template-rows: repeat(6, 1fr);
                gap: 5px; /* Adjust the gap between squares as needed */
            }

            .square {
                width: 40px; /* Adjust the size of the squares as needed */
                height: 40px;
                background-color: #ddd; /* Adjust the background color as needed */
                border: 1px solid #ccc; /* Optional: Add a border to the squares */
                display: flex;
                align-items: center;
                justify-content: center;
                color: black; /* Set text color to black */
            }
            .scroll-button {
                display: block;
                margin: 10px auto;
                padding: 10px;
                font-size: 20px;
                cursor: pointer;
            }
        </style>
        <center><h1 style="color: black;">Physical</h1></center>
        <div class="centered-box-container">
            <div class="background-box">
                <div class="percentage-box" id="percentageBox">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox1">
                            <center><h1>{{ stretch_pct }}</h1></center>
                            <center><h4>{{ stretch_label }}</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_stretch7 }}/{{ stretch_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_stretch42 }}/{{ stretch_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_stretch84 }}/{{ stretch_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox2">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox2">
                            <center><h1>{{ mobility_pct }}</h1></center>
                            <center><h4>{{ mobility_label }}</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_mobility7 }}/{{ mobility_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_mobility42 }}/{{ mobility_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_mobility84 }}/{{ mobility_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox3">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox3">
                            <center><h1>{{ coordination_pct }}</h1></center>
                            <center><h5>{{ coordination_label }}</h5></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_coordination7 }}/{{ coordination_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_coordination42 }}/{{ coordination_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_coordination84 }}/{{ coordination_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox4">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox4">
                            <center><h1>{{ balance_pct }}</h1></center>
                            <center><h4>{{ balance_label }}</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_balance7 }}/{{ balance_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_balance42 }}/{{ balance_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_balance84 }}/{{ balance_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox5">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox5">
                            <center><h1>{{ speed_pct }}</h1></center>
                            <center><h4>{{ speed_label }}</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_speed7 }}/{{ speed_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_speed42 }}/{{ speed_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_speed84 }}/{{ speed_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox6">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox6">
                            <center><h1>{{ agility_pct }}</h1></center>
                            <center><h4>{{ agility_label }}</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_agility7 }}/{{ agility_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_agility42 }}/{{ agility_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_agility84 }}/{{ agility_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox7">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox7">
                            <center><h1>{{ altitude_pct }}</h1></center>
                            <center><h4>{{ altitude_label }}</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_altitude7 }}/{{ altitude_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_altitude42 }}/{{ altitude_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_altitude84 }}/{{ altitude_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox8">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox8">
                            <center><h1>{{ strength_pct }}</h1></center>
                            <center><h4>{{ strength_label }}</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_strength7 }}/{{ strength_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_strength42 }}/{{ strength_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_strength84 }}/{{ strength_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox9">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox9">
                            <center><h1>{{ power_pct }}</h1></center>
                            <center><h4>{{ power_label }}</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_power7 }}/{{ power_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_power42 }}/{{ power_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_power84 }}/{{ power_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox10">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox10">
                            <center><h1>{{ reaction_pct }}</h1></center>
                            <center><h4>{{ reaction_label }}</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_reaction7 }}/{{ reaction_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_reaction42 }}/{{ reaction_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_reaction84 }}/{{ reaction_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br/><hr/>
        <center><h1 style="color: black;">Mental</h1></center>
        <div class="centered-box-container">
            <div class="background-box">
                <div class="percentage-box" id="percentageBox11">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox11">
                            <center><h1>{{ read_pct }}</h1></center>
                            <center><h4>Stress</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_read7 }}/{{ read_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_read42 }}/{{ read_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_read84 }}/{{ read_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox12">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox12">
                            <center><h1>{{ read_pct }}</h1></center>
                            <center><h5>Motivation</h5></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_read7 }}/{{ read_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_read42 }}/{{ read_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_read84 }}/{{ read_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox13">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox13">
                            <center><h1>{{ read_pct }}</h1></center>
                            <center><h4>{{ read_label }}</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_read7 }}/{{ read_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_read42 }}/{{ read_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_read84 }}/{{ read_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox14">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox14">
                            <center><h1>{{ kindness_pct }}</h1></center>
                            <center><h4>{{ kindness_label }}</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_kindness7 }}/{{ kindness_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_kindness42 }}/{{ kindness_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_kindness84 }}/{{ kindness_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox15">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox15">
                            <center><h1>{{ visualize_pct }}</h1></center>
                            <center><h4>{{ visualize_label }}</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_visualize7 }}/{{ visualize_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_visualize42 }}/{{ visualize_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_visualize84 }}/{{ visualize_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox16">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox16">
                            <center><h1>{{ medidate_pct }}</h1></center>
                            <center><h4>{{ medidate_label }}</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_medidate7 }}/{{ medidate_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_medidate42 }}/{{ medidate_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_medidate84 }}/{{ medidate_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox17">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox17">
                            <center><h1>{{ focus_pct }}</h1></center>
                            <center><h4>{{ focus_label }}</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_focus7 }}/{{ focus_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_focus42 }}/{{ focus_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_focus84 }}/{{ focus_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox18">
                    <div class="horizontal-container">
                        <div class="labelbox" id="labelbox18">
                            <center><h1>{{ be_social_pct }}</h1></center>
                            <center><h4>{{ be_social_label }}</h4></center>
                        </div>
                        <div>
                            <center><h5>Week</h5></center>
                            <center><h1>{{ true_be_social7 }}/{{ be_social_limit }}</h1></center>
                        </div>
                        <div>
                            <center><h5>6-Week</h5></center>
                            <center><h1>{{ true_be_social42 }}/{{ be_social_limit42 }}</h1></center>
                        </div>
                        <div>
                            <center><h5>12-Week</h5></center>
                            <center><h1>{{ true_be_social84 }}/{{ be_social_limit84 }}</h1></center>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br/><hr/>
        <center><h1 style="color: black;">Recovery</h1></center>
        <canvas id="sleepChart" width="400" height="200"></canvas>
        <div class="centered-box-container">
            <div class="background-box">
                <div class="percentage-box" id="percentageBox19">
                    <center><h1>61%</h1></center>
                    <center><h5>Foam Roll</h5></center>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox20">
                    <center><h1>77%</h1></center>
                    <center><h5>NormaTec</h5></center>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox21">
                    <center><h1>4%</h1></center>
                    <center><h6>Ice</h6></center>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox22">
                    <center><h1>89%</h1></center>
                    <center><h5>Altitude</h5></center>
                </div>
            </div>
        </div>
        <br/><hr/>
        <center><h1 style="color: black;">Nutrition</h1></center>
        <canvas id="waterChart" width="400" height="200"></canvas>
        <div class="centered-box-container">
            <div class="background-box">
                <div class="percentage-box" id="percentageBox23">
                    <center><h1>{{ stretch_pct }}</h1></center>
                    <center><h5>No Sweets</h5></center>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox24">
                    <center><h1>{{ mobility_pct }}</h1></center>
                    <center><h5>B Alanine</h5></center>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox25">
                    <center><h1>0.77</h1></center>
                    <center><h6>Vitamin D</h6></center>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox26">
                    <center><h1>0.89</h1></center>
                    <center><h5>Creatine</h5></center>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox27">
                    <center><h1>0.34</h1></center>
                    <center><h5>Anti-Ox</h5></center>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox28">
                    <center><h1>0.76</h1></center>
                    <center><h5>Fruit</h5></center>
                </div>
            </div>
            <div class="background-box">
                <div class="percentage-box" id="percentageBox29">
                    <center><h1>0.05</h1></center>
                    <center><h5>Veggie</h5></center>
                </div>
        </div>
    </div>
</div>
<script>
    function applyGradientStyles(elementId, percentage) {
        const startColor = { r: 255, g: 0, b: 0 }; // Light red
        const middleColor = { r: 255, g: 255, b: 0 }; // Light yellow
        const endColor = { r: 119, g: 199, b: 136 }; // Light green
        const startColor2 = { r: 151, g: 0, b: 0 }; // Dark red
        const middleColor2 = { r: 151, g: 128, b: 0 }; // Dark yellow
        const endColor2 = { r: 0, g: 151, b: 0 }; // Dark green

        let color;
        if (percentage <= 0.5) {
            // Interpolate between startColor and middleColor
            const factor = percentage * 2;
            color = {
                r: Math.round(startColor.r + (middleColor.r - startColor.r) * factor),
                g: Math.round(startColor.g + (middleColor.g - startColor.g) * factor),
                b: Math.round(startColor.b + (middleColor.b - startColor.b) * factor),
            };
        } else {
            // Interpolate between middleColor and endColor
            const factor = (percentage - 0.5) * 2;
            color = {
                r: Math.round(middleColor.r + (endColor.r - middleColor.r) * factor),
                g: Math.round(middleColor.g + (endColor.g - middleColor.g) * factor),
                b: Math.round(middleColor.b + (endColor.b - middleColor.b) * factor),
            };
        }

        let color2;
        if (percentage <= 0.5) {
            // Interpolate between startColor and middleColor
            const factor = percentage * 2;
            color2 = {
                r: Math.round(startColor2.r + (middleColor2.r - startColor2.r) * factor),
                g: Math.round(startColor2.g + (middleColor2.g - startColor2.g) * factor),
                b: Math.round(startColor2.b + (middleColor2.b - startColor2.b) * factor),
            };
        } else {
            // Interpolate between middleColor and endColor
            const factor = (percentage - 0.5) * 2;
            color2 = {
                r: Math.round(middleColor2.r + (endColor2.r - middleColor2.r) * factor),
                g: Math.round(middleColor2.g + (endColor2.g - middleColor2.g) * factor),
                b: Math.round(middleColor2.b + (endColor2.b - middleColor2.b) * factor),
            };
        }

        const rgbaColor = `rgba(${color.r}, ${color.g}, ${color.b}, 0.33)`; // For background with transparency
        const rgbColor = `rgb(${color2.r}, ${color2.g}, ${color2.b})`; // For text, border, and shadow

        const box = document.getElementById(elementId);
        box.style.backgroundColor = rgbaColor;
        box.style.color = rgbColor; // Set text color
        box.style.borderColor = rgbColor; // Set border color
        box.style.boxShadow = `0px 0px 5px ${rgbColor}`; // Set shadow
    }

    function applyGradientStyles2(elementId, percentage) {
        const startColor = { r: 255, g: 0, b: 0 }; // Light red
        const middleColor = { r: 255, g: 255, b: 0 }; // Light yellow
        const endColor = { r: 119, g: 199, b: 136 }; // Light green
        const startColor2 = { r: 151, g: 0, b: 0 }; // Dark red
        const middleColor2 = { r: 151, g: 128, b: 0 }; // Dark yellow
        const endColor2 = { r: 0, g: 151, b: 0 }; // Dark green

        let color;
        if (percentage <= 0.5) {
            // Interpolate between startColor and middleColor
            const factor = percentage * 2;
            color = {
                r: Math.round(startColor.r + (middleColor.r - startColor.r) * factor),
                g: Math.round(startColor.g + (middleColor.g - startColor.g) * factor),
                b: Math.round(startColor.b + (middleColor.b - startColor.b) * factor),
            };
        } else {
            // Interpolate between middleColor and endColor
            const factor = (percentage - 0.5) * 2;
            color = {
                r: Math.round(middleColor.r + (endColor.r - middleColor.r) * factor),
                g: Math.round(middleColor.g + (endColor.g - middleColor.g) * factor),
                b: Math.round(middleColor.b + (endColor.b - middleColor.b) * factor),
            };
        }

        let color2;
        if (percentage <= 0.5) {
            // Interpolate between startColor and middleColor
            const factor = percentage * 2;
            color2 = {
                r: Math.round(startColor2.r + (middleColor2.r - startColor2.r) * factor),
                g: Math.round(startColor2.g + (middleColor2.g - startColor2.g) * factor),
                b: Math.round(startColor2.b + (middleColor2.b - startColor2.b) * factor),
            };
        } else {
            // Interpolate between middleColor and endColor
            const factor = (percentage - 0.5) * 2;
            color2 = {
                r: Math.round(middleColor2.r + (endColor2.r - middleColor2.r) * factor),
                g: Math.round(middleColor2.g + (endColor2.g - middleColor2.g) * factor),
                b: Math.round(middleColor2.b + (endColor2.b - middleColor2.b) * factor),
            };
        }

        const rgbaColor = `rgba(${color2.r}, ${color2.g}, ${color2.b}, 0.33)`; // For background with transparency
        const rgbColor = `rgb(${color2.r}, ${color2.g}, ${color2.b})`; // For text, border, and shadow

        const box = document.getElementById(elementId);
        box.style.backgroundColor = rgbaColor;
        box.style.color = rgbColor; // Set text color
        box.style.borderColor = rgbColor; // Set border color
        box.style.boxShadow = `0px 0px 5px ${rgbColor}`; // Set shadow
    }

    // Apply to specific elements
    applyGradientStyles('percentageBox', {{ stretch_pct }});
    applyGradientStyles2('labelbox1', {{ stretch_pct }});
    applyGradientStyles('percentageBox2', {{ mobility_pct }});
    applyGradientStyles2('labelbox2', {{ mobility_pct }});
    applyGradientStyles('percentageBox3', {{ coordination_pct }});
    applyGradientStyles2('labelbox3', {{ coordination_pct }});
    applyGradientStyles('percentageBox4', {{balance_pct}});
    applyGradientStyles2('labelbox4', {{balance_pct}});
    applyGradientStyles('percentageBox5', {{ speed_pct }});
    applyGradientStyles2('labelbox5', {{ speed_pct }});
    applyGradientStyles('percentageBox6', {{ agility_pct }});
    applyGradientStyles2('labelbox6', {{ agility_pct }});
    applyGradientStyles('percentageBox7', {{ altitude_pct }});
    applyGradientStyles2('labelbox7', {{ altitude_pct }});
    applyGradientStyles('percentageBox8', {{ strength_pct }});
    applyGradientStyles2('labelbox8', {{ strength_pct }});
    applyGradientStyles('percentageBox9', {{ power_pct }});
    applyGradientStyles2('labelbox9', {{ power_pct }});
    applyGradientStyles('percentageBox10', {{ reaction_pct }});
    applyGradientStyles2('labelbox10', {{ reaction_pct }});
    applyGradientStyles('percentageBox11', 1);
    applyGradientStyles2('labelbox11', 1);
    applyGradientStyles('percentageBox12', 1);
    applyGradientStyles2('labelbox12', 1);
    applyGradientStyles('percentageBox13', {{ read_pct }});
    applyGradientStyles2('labelbox13', {{ read_pct }});
    applyGradientStyles('percentageBox14', {{ kindness_pct }});
    applyGradientStyles2('labelbox14', {{ kindness_pct }});
    applyGradientStyles('percentageBox15', {{ visualize_pct }});
    applyGradientStyles2('labelbox15', {{ visualize_pct }});
    applyGradientStyles('percentageBox16', {{ medidate_pct }});
    applyGradientStyles2('labelbox16', {{ medidate_pct }});
    applyGradientStyles('percentageBox17', {{ focus_pct }});
    applyGradientStyles2('labelbox17', {{ focus_pct }});
    applyGradientStyles('percentageBox18', {{ be_social_pct }});
    applyGradientStyles2('labelbox18', {{ be_social_pct }});
    applyGradientStyles('percentageBox19', 1);
    applyGradientStyles('percentageBox20', 0.61);
    applyGradientStyles('percentageBox21', 0.77);
    applyGradientStyles('percentageBox22', 0.04);
    applyGradientStyles('percentageBox23', 0.89);
    applyGradientStyles('percentageBox24', 0.34);
    applyGradientStyles('percentageBox25', 0.76);
    applyGradientStyles('percentageBox26', 0.05);
    applyGradientStyles('percentageBox27', 0.76);
    applyGradientStyles('percentageBox28', 0.05);
    applyGradientStyles('percentageBox29', 1);
</script>

<script>        // Water Chart
    const data = {
        labels: ['2023-04-01', '2023-04-02', '2023-04-03', '2023-04-04', '2023-04-05', '2023-04-06', '2023-04-07'],
        datasets: [{
            label: 'Water Intake',
            data: [120, 119, 83, 85, 112, 103, 90],
            fill: true,
            borderColor: 'rgb(75, 192, 192)',
            tension: 0.1,
            backgroundColor: 'rgba(75, 192, 192, 0.2)' // Adjust for shading
        }]
    };

    const config = {
        type: 'line',
        data: data,
        options: {
            scales: {
                x: {
                    type: 'time',
                    time: {
                        unit: 'day'
                    },
                    title: {
                        display: true,
                        text: 'Date'
                    }
                },
                y: {
                    beginAtZero: false,
                    min: 25, // Set y scale from 25
                    max: 175, // to 175
                    title: {
                        display: true,
                        text: 'Ounces'
                    }
                }
            },
            plugins: {
                annotation: {
                    annotations: {
                        line1: {
                            type: 'line',
                            yMin: 100,
                            yMax: 100,
                            borderColor: 'rgb(0, 99, 132)',
                            borderWidth: 2,
                            borderDash: [10, 5],
                            label: {
                                enabled: true,
                                content: 'Target'
                            }
                        }
                    }
                }
            }
        }
    };

    const waterChart = new Chart(
        document.getElementById('waterChart'),
        config
    );
</script>
<script>        // Sleep Chart
    const sleep_data = {
        labels: ['2023-04-01', '2023-04-02', '2023-04-03', '2023-04-04', '2023-04-05', '2023-04-06', '2023-04-07'],
        datasets: [{
            label: 'Sleep',
            data: [7, 9.25, 9, 8.5, 9, 8.25, 9],
            fill: true,
            borderColor: 'rgb(133, 31, 192)',
            tension: 0.1,
            backgroundColor: 'rgba(133, 31, 192, 0.2)' // Adjust for shading
        }]
    };

    const sleep_config = {
        type: 'line',
        data: sleep_data,
        options: {
            scales: {
                x: {
                    type: 'time',
                    time: {
                        unit: 'day'
                    },
                    title: {
                        display: true,
                        text: 'Date'
                    }
                },
                y: {
                    beginAtZero: false,
                    min: 4, // Set y scale from 4
                    max: 12, // to 12
                    title: {
                        display: true,
                        text: 'Hours'
                    }
                }
            },
            plugins: {
                annotation: {
                    annotations: {
                        line1: {
                            type: 'line',
                            yMin: 8,
                            yMax: 8,
                            borderColor: 'rgb(56, 30, 72)',
                            borderWidth: 2,
                            borderDash: [10, 5],
                            label: {
                                enabled: true,
                                content: 'Target'
                            }
                        }
                    }
                }
            }
        }
    };

    const sleepChart = new Chart(
        document.getElementById('sleepChart'),
        sleep_config
    );
</script>

<!-- Modal Box -->
    <div id="myModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
            <p id="modalTitle">Habit History for Stretch</p>
        <button id="scrollUp" class="scroll-button">↑</button>
            <div class="calendar-grid">
            <!-- Squares will be generated by JavaScript -->
        </div>
        <button id="scrollDown" class="scroll-button">↓</button>
    </div>
</div>

<script>
    document.getElementById('percentageBox').onclick = function() {
            document.getElementById('myModal').style.display = "block";
    }

        document.getElementsByClassName('close')[0].onclick = function() {
            document.getElementById('myModal').style.display = "none";
    }

    window.onclick = function(event) {
            if (event.target == document.getElementById('myModal')) {
                document.getElementById('myModal').style.display = "none";
        }
    }
</script>

<script>
    document.getElementById('scrollUp').addEventListener('click', function() {
        const grid = document.getElementById('calendarGrid');
        grid.scrollBy(0, -40); // Adjust the scroll amount as needed
    });

    document.getElementById('scrollDown').addEventListener('click', function() {
        const grid = document.getElementById('calendarGrid');
        grid.scrollBy(0, 40); // Adjust the scroll amount as needed
    });
</script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const habits = [
            { id: 'percentageBox', label: 'Stretch', key: 'stretch' },
            { id: 'percentageBox2', label: 'Mobility', key: 'mobility' },
            { id: 'percentageBox3', label: 'Coordination', key: 'coordination' },
            { id: 'percentageBox4', label: 'Balance', key: 'balance' },
            { id: 'percentageBox5', label: 'Speed', key: 'speed' },
            { id: 'percentageBox6', label: 'Agility', key: 'agility' },
            { id: 'percentageBox7', label: 'Altitude', key: 'altitude' },
            { id: 'percentageBox8', label: 'Strength', key: 'strength' },
            { id: 'percentageBox9', label: 'Power', key: 'power' },
            { id: 'percentageBox10', label: 'Reaction', key: 'reaction' },
            //{ id: 'percentagebox11', label: 'Read', key: 'read' },
            //{ id: 'percentageBox12', label: 'Motivation', key: 'motivation' },
            { id: 'percentageBox13', label: 'Read', key: 'read' },
            { id: 'percentageBox14', label: 'Kindness', key: 'kindness' },
            { id: 'percentageBox15', label: 'Visualize', key: 'visualize' },
            { id: 'percentageBox16', label: 'Meditate', key: 'meditate' },
            { id: 'percentageBox17', label: 'Focus', key: 'focus' },
            { id: 'percentageBox18', label: 'Socialize', key: 'be_social' },
            //{ id: 'percentageBox19', label: 'Sleep', key: 'sleep' },
            { id: 'percentageBox20', label: 'Foam Roll', key: 'foam_roll' },
            { id: 'percentageBox21', label: 'NormaTec', key: 'normatec' },
            { id: 'percentageBox22', label: 'Ice', key: 'ice' },
            { id: 'percentageBox23', label: 'Altitude', key: 'altitude' },
            { id: 'percentageBox24', label: 'No Sweets', key: 'no_sweets' },
            { id: 'percentageBox25', label: 'B Alanine', key: 'b_alanine' },
            { id: 'percentageBox26', label: 'Vitamin D', key: 'vitamin_d' },
            { id: 'percentageBox27', label: 'Creatine', key: 'creatine' },
            { id: 'percentageBox28', label: 'Anti-Ox', key: 'anti_ox' },
            { id: 'percentageBox29', label: 'Fruit', key: 'fruit' },
            { id: 'percentageBox30', label: 'Veggie', key: 'veggie' }
        ];

        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let offset = 0;
        let currentHabitKey = '';

        // Get the daily data from the template context
        const dailyData = JSON.parse('{{ daily_data|escapejs }}');
        console.log("Daily Data:", dailyData);

        function generateCalendar(month, year, offset, habitKey) {
            const calendarGrid = document.querySelector('.calendar-grid');
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const daysInPrevMonth = new Date(year, month, 0).getDate();

            // Clear existing squares
            calendarGrid.innerHTML = '';

            // Fill the squares with dates
            for (let i = 0; i < 42; i++) {
                const square = document.createElement('div');
                square.classList.add('square');

                const dateIndex = i - firstDay + 1 + offset * 7;
                let date;

                if (dateIndex < 1) {
                    // Dates from the previous month
                    date = new Date(year, month - 1, daysInPrevMonth + dateIndex);
                    square.textContent = date.getDate() === 1 ? date.toLocaleString('default', { month: 'short' }) : date.getDate();
                } else if (dateIndex > daysInMonth) {
                    // Dates from the next month
                    date = new Date(year, month + 1, dateIndex - daysInMonth);
                    square.textContent = date.getDate() === 1 ? date.toLocaleString('default', { month: 'short' }) : date.getDate();
                } else {
                    // Dates from the current month
                    date = new Date(year, month, dateIndex);
                    square.textContent = dateIndex === 1 ? date.toLocaleString('default', { month: 'short' }) : dateIndex;
                }

                // Format the date as a string
                const dateString = date.toISOString().split('T')[0];
                console.log("Processing date:", dateString);

                // Check if the date is in the dailyData object
                if (dailyData.hasOwnProperty(dateString)) {
                    const habitValue = dailyData[dateString][habitKey];
                    square.style.backgroundColor = habitValue ? 'green' : 'red';
                }

                calendarGrid.appendChild(square);
            }
        }

        habits.forEach(habit => {
            const habitElement = document.getElementById(habit.id);
            if (habitElement) {
                habitElement.onclick = function() {
                    const modalTitle = document.getElementById('modalTitle');
                    if (modalTitle) {
                        modalTitle.textContent = `Habit History for ${habit.label}`;
                    } else {
                        console.error('Element with ID modalTitle not found.');
                    }
                    currentHabitKey = habit.key;
                    generateCalendar(currentMonth, currentYear, offset, currentHabitKey);
                    document.getElementById('myModal').style.display = "block";
                };
            } else {
                console.error(`Element with ID ${habit.id} not found.`);
            }
        });

        document.getElementById('scrollUp').addEventListener('click', function() {
            offset -= 1;
            generateCalendar(currentMonth, currentYear, offset, currentHabitKey);
        });

        document.getElementById('scrollDown').addEventListener('click', function() {
            offset += 1;
            generateCalendar(currentMonth, currentYear, offset, currentHabitKey);
        });
    });
</script>
{% endblock %}